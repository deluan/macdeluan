---
- name: install
  hosts: localhost
  vars:
    ruby_version: 2.2.3
    node_version: 6.4.0
    local_home: "{{ lookup('env','HOME') }}"

  tasks:
  - name: Install basic tools using brew
    homebrew: name={{item}} state=present
    with_items: [wget, jq, git, gawk, mercurial, gradle, fzf, direnv, go, pyenv]

  - name: Creates .ssh folder
    shell: mkdir ~/.ssh creates=~/.ssh

  - name: Install Vagrant Insecure Private Key
    copy: src=./files/vagrant_rsa dest=~/.ssh/vagrant_rsa mode=0600

  - name: Install profile.d scripts
    synchronize: src=.profile.d dest=~/ archive=yes checksum=yes times=no

  - name: Install dotfiles
    synchronize: src=dotfiles/ dest=~/ archive=yes checksum=yes times=no

  - name: Install iTerm2 Shell Integration
    get_url: url=https://iterm2.com/misc/bash_startup.in dest=~/.iterm2_shell_integration.bash

  - name: Install RVM
    shell: curl -L https://get.rvm.io | bash -s stable --ruby={{ruby_version}} --ignore-dotfiles creates=~/.rvm/scripts/rvm

  - name: Install NVM
    git: repo=https://github.com/creationix/nvm.git dest=~/.nvm update=no

  - name: Install Node
    shell: source ~/.nvm/nvm.sh && nvm install {{node_version}} && nvm alias default {{node_version}} creates=~/.nvm/alias/default

  - name: Install DCD
    npm: executable={{local_home}}/.nvm/versions/node/v{{node_version}}/bin/npm name=dcd global=yes

  - name: Create bin folder
    file: path=~/bin state=directory

  - name: Install my personal tap
    homebrew_tap: tap=deluan/tap state=present

  - name: Install Grails.sh
    homebrew: name=grails.sh state=present

  - name: Install Bash Autocompletion
    homebrew: name=bash-completion state=present

  - name: Install Autocompletion tap
    homebrew_tap: tap=homebrew/completions state=present

  - name: Install Homebrew Cask
    homebrew_tap: tap=caskroom/cask state=present

  - name: Install Dev tools using brew cask
    homebrew_cask: name={{item}} state=present
    with_items: [visual-studio-code, google-chrome, iterm2-nightly, sourcetree]

  # - name: Install Other Applications using brew cask
  #   homebrew_cask: name={{item}} state=present
  #   with_items: [handbrake, vlc, transmission, disk-inventory-x, flux, calibre,
  #     1password, intellij-idea, plex-media-player, screenhero, mysqlworkbench,
  #     dropbox, bittorrent-sync, atom, iconping, virtualbox, vagrant, bitbar]
